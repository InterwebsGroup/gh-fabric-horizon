{%- comment -%}
  Product image gallery — hero image + thumbnail row.
  First thumbnail = selected variant image (updates on variant change).
  Remaining thumbnails = static images from section settings (editable in Shopify editor).
  Empty slots render placeholder SVGs for layout testing.
  Usage: {% render 'product-gallery', product: product, section: section %}
{%- endcomment -%}

{%- liquid
  assign selected_variant = product.selected_or_first_available_variant
  assign hero_media = selected_variant.featured_media | default: product.featured_media
-%}

<div class="product-gallery" data-product-gallery>
  {%- if hero_media -%}
    <div class="product-gallery__hero">
      <img
        data-gallery-hero
        src="{{ hero_media | image_url: width: 900 }}"
        srcset="{{ hero_media | image_url: width: 400 }} 400w, {{ hero_media | image_url: width: 600 }} 600w, {{ hero_media | image_url: width: 900 }} 900w, {{ hero_media | image_url: width: 1200 }} 1200w"
        sizes="(min-width: 768px) 50vw, 100vw"
        alt="{{ hero_media.alt | escape | default: product.title }}"
        width="{{ hero_media.preview_image.width }}"
        height="{{ hero_media.preview_image.height }}"
        loading="eager"
        draggable="false"
      >
    </div>

    <div class="product-gallery__thumbs" data-gallery-thumbs>
      {%- comment -%} Variant thumbnail — always first {%- endcomment -%}
      <button
        type="button"
        class="product-gallery__thumb product-gallery__thumb--active"
        data-gallery-thumb
        data-variant-thumb
        data-full-src="{{ hero_media | image_url: width: 900 }}"
        data-full-srcset="{{ hero_media | image_url: width: 400 }} 400w, {{ hero_media | image_url: width: 600 }} 600w, {{ hero_media | image_url: width: 900 }} 900w, {{ hero_media | image_url: width: 1200 }} 1200w"
        data-full-alt="{{ hero_media.alt | escape | default: product.title }}"
        aria-label="Variant image"
        aria-pressed="true"
      >
        <img
          src="{{ hero_media | image_url: width: 100 }}"
          alt="{{ hero_media.alt | escape | default: product.title }}"
          width="80"
          height="80"
          loading="eager"
          draggable="false"
        >
      </button>

      {%- comment -%} Static gallery images from section settings (placeholders when empty) {%- endcomment -%}
      {%- for i in (1..6) -%}
        {%- case i -%}
          {%- when 1 -%}{%- assign gallery_img = section.settings.gallery_image_1 -%}
          {%- when 2 -%}{%- assign gallery_img = section.settings.gallery_image_2 -%}
          {%- when 3 -%}{%- assign gallery_img = section.settings.gallery_image_3 -%}
          {%- when 4 -%}{%- assign gallery_img = section.settings.gallery_image_4 -%}
          {%- when 5 -%}{%- assign gallery_img = section.settings.gallery_image_5 -%}
          {%- when 6 -%}{%- assign gallery_img = section.settings.gallery_image_6 -%}
        {%- endcase -%}
        {%- if gallery_img != blank -%}
          <button
            type="button"
            class="product-gallery__thumb"
            data-gallery-thumb
            data-full-src="{{ gallery_img | image_url: width: 900 }}"
            data-full-srcset="{{ gallery_img | image_url: width: 400 }} 400w, {{ gallery_img | image_url: width: 600 }} 600w, {{ gallery_img | image_url: width: 900 }} 900w, {{ gallery_img | image_url: width: 1200 }} 1200w"
            data-full-alt="{{ gallery_img.alt | escape | default: product.title }}"
            aria-label="Gallery image {{ i }}"
          >
            <img
              src="{{ gallery_img | image_url: width: 100 }}"
              alt="{{ gallery_img.alt | escape | default: product.title }}"
              width="80"
              height="80"
              loading="lazy"
              draggable="false"
            >
          </button>
        {%- else -%}
          <div class="product-gallery__thumb product-gallery__thumb--placeholder">
            {{ 'product-' | append: i | placeholder_svg_tag: 'product-gallery__placeholder-thumb' }}
          </div>
        {%- endif -%}
      {%- endfor -%}
    </div>
  {%- else -%}
    <div class="product-gallery__hero">
      {{ 'product-1' | placeholder_svg_tag: 'product-gallery__placeholder' }}
    </div>
  {%- endif -%}
</div>
